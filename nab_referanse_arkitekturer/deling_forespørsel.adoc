:lang: no
:doctitle: Deling av data på forespørsel (eOppslag)
:keywords: Referansearkitekturer

include::../plattform_felles/includes/commonincludes.adoc[]
=== Om deling av data på forspørsel

Mønsteret dekker oppslag i informasjon, dvs. forespørsel om informasjon mellom to parter, hvor en prosess hos den ene part typisk er avhengig av informasjon fra den andre for å fortsette.

Beskrivelsen her er avgrenset til det å tilby og konsumere data gjennom APIer. Dette skal dekke både sikrede APIer hvor tilgangsstyring løses ved bruk av blant annet fellestjeneste, og åpne APIer som tilbyr åpent tilgjengelige data. En stor del av beskrivelsene tar for seg oppsett og bruk av tjenester tilknyttet tilgangsstyring, men dette er ikke obligatorisk for APIer som tilbyr åpne data.

I innledningen til referansearkitekturer er det skissert [red]**fem ulike kapabilitetsområder** og identifisert overordnede kapabiliteter som inngår i de ulike referansearkitekturene. I dette kapittelet detaljeres kapabilitetene tilknyttet eOppslag. Først er det en modell med mer detaljerte kapabiliteter som siden beskrives i detalj gjennom prosesstegene som skal til for å realisere kapabiliteten. Det vises også til forretningstjenestene og noe av kjerneinformasjonen som benyttes i prosessene.

Modellene viser relasjonene mellom de ulike elementene og elementene er forklart i tabellene under hver modell. Elementer som benyttes flere ganger, f.eks. rollen som tilbyder, forklares kun tilknyttet modellen på høyest nivå.

=== Oversikt deling av data på forespørsel
Modellen under viser de kapabilitetene en tilbyder og en konsument må ha for å dele data gjennom tilgangsstyrte APIer. 

image:./media/Deling på forespørsel.png[alt="Bilde mangler", width=750]

[cols ="1,1,3", options="header"]
.Elementer i figur for deling av data på forespørsel
|===
|Element
|Elementtype
|Beskrivelse

|Tilbyder av data
|Rolle
|Den som tilbyr eller tilgjengeliggjør data for andre. Kan ofte være samme aktør som dataforvalter

den part som besitter informasjon som kan deles


|Konsument (databruker)
|Rolle
|Den som bruker data. Konsument kan også benyttes om en som benytter et API uavhengig av formål.

den part som i en egen virksomhetsprosess har behov for informasjon fra en annen part


|Tilgjengeliggjøring av data
|Kapabilitet
|Evnen til å gjøre data tilgjengelig for aktører utenfor egen virksomhet.

|Registerering av sikkert API
|Sub-kapabilitet
|Del av "tilgjengeliggjøreing av data". Evnen til å registrere eget API i fellestjenester så det blir tilgjengelig for andre aktører.

|Avgi forespurte data
|Sub-kapabilitet
|Del av "tilgjengeliggjøreing av data". Evene til å avgi data på forespørsel gjennom et egnet API. Kan omfatte tilgangsstyring.

|Innhenting av data
|Kapabilitet
|Evenen til å hente tilbydte data fra annen aktør.

|Få tilgang til API
|Sub-kapabilitet
|Evnen til å få tilgang til tilbydte data fra annen aktør. 


|Delegering av rettigheter til databehandler
|Sub-kapabilitet
|Evnen til å delegere rettigheter til databehandler som utfører oppgaver på vegne av behandlingsansvarlig


|Slå opp data gjennom et API
|Sub-kapabilitet
|Evnen til å slå opp og hente data gjennom et eksternt API.

|===

=== Detaljerte beskrivelser

===== Registrering av sikkert API

Modellen under detaljerer kapabiliteten "Registerering av sikkert API". 
image:./media/registrere API.png[alt="Bilde mangler", width=750]

[cols ="1,1,3", options="header"]
.Elementer i figur for registrering av API
|===
|Element
|Elementtype
|Beskrivelse

|Inngå avtale om tilgang til data
|Prosess
|

|Bruksavtale
|Kontrakt
|

|Opprette tilbyder hos levareandør av tokentjeneste
|Prosess
|

|Registrere API
|Prosess
|

|Tildele tilganger til API
|Prosess
|

|Bruksvilkår
|Forretningsobjekt
|

|Registreringstjeneste for tilbyder av API
|Forretningstjeneste
|

|API-registreringstjeneste for tilbyder
|Forretningstjeneste
|

|Token egenskaper
|Forretningsobjekt
|

|Tilgangsregistreringstjeneste
|Forretningstjeneste
|

|Orgnr. databruker
|Forretningsobjekt
|

|===


===== Avgi forespurte data

image:./media/avgi data.png[alt="Bilde mangler", width=400]


[cols ="1,1,3", options="header"]
.Elementer i figur for å avgi data
|===
|Element
|Elementtype
|Beskrivelse

|Policytjeneste
|Forretningstjeneste
|Intern tjeneste hos tilbyder for å håndheve tilgangsnivåpolicy ved tilgangsstyring.

|Motta forespørsel om oppslag
|Forretningsprosess
|

|Kontroller tilgang
|Forretningsprosess
|Prosessen med å kontrollere om konsumenten har rettigheter til å få de forespurte data.

|Avgi data
|Forretningsprosess
|Prosessen med å gi svar på forespørselen.

|Verifiseringstjeneste
|Forretningstjeneste
|Tjeneste for å verifisere autentiserings- og autorisasjonsdata i mottatt forespørsel.

|===


===== Få tilgang til API

image:./media/få tilgang til API.png[alt="Bilde mangler", width=750]


[cols ="1,1,3", options="header"]
.Elementer i figur for å få tilgang til API
|===
|Element
|Elementtype
|Beskrivelse

|Bruksavtale
|
|

|Finne/få kjennskap til API
|
|

|Inngå avtale om tilgang til data
|
|

|Inngå bruksavtale med leverandør av tokentjenester
|
|

|Delegere tilgang til leverandør
|
|Dette gjøres bare om driften håndteres av en ekstern leverandør og det foreligger en tjenesteavtale mellom konsument og tjenesteleverandør

|Registrer klient med tildelt tilgang
|
|

|Leverandør registrerer klient med tildelt tilgang
|
|

|API-søk
|
|

|Avtaletjeneste
|
|

|Registreringstjeneste for API-bruker
|
|

|===


===== Delegering av rettigheter til databehandler

image:./media/delegering av rettigheter.png[alt="Bilde mangler", width=350]

[cols ="1,1,3", options="header"]
.Elementer i figur for delegering av rettigheter til databehandler
|===
|Element
|Elementtype
|Beskrivelse

|Tjenesteavtale
|Kontrakt
|

|Leverandør
|Rolle
|

|Inngå avtale med leverandør
|Prosess
|

|Registrere delegert tilgang
|Prosess
|

|Registreringstjeneste for representasjons-forhold
|Forretningstjeneste
|

|===

===== Slå opp data gjennom et API


image:./media/slå opp data.png[alt="Bilde mangler", width=350]

[cols ="1,1,3", options="header"]
.Elementer i figur for å slå opp data
|===
|Element
|Elementtype
|Beskrivelse

|Hent teknisk endepunkt ved behov
|
|

|Be om tilgangstoken
|
|

|Utfør tjenestekall
|
|

|Adressetjeneste
|
|

|Tokentjeneste
|
|

|Representasjonstjeneste
|
|

|===


